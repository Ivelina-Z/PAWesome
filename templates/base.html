{% load static %}
{% load get_group_tag %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    {% block styles %}
    {% endblock styles %}

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
{#    find the correct font awesome link with sha #}
    <link rel="stylesheet" href="{% static 'styles/style.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>PAWesome</title>
</head>

<body class="d-flex flex-column min-vh-100">
    {% block navigation %}
        <header>
            {% if not request.user.is_authenticated %}
                <nav class="navbar navbar-expand-lg navbar-light bg-light mb-5">
                    <ul class="container navbar-nav mx-auto justify-content-between">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'animals-all' %}">Животни</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'how-to-help' %}">Искам да помогна</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'homepage' %}">
                                <img class="img-fluid"
                                     style="height: 150px"
                                     src="{% static 'images/logo.png' %}"  alt="logo">
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href={% url 'all-organizations'%}>Организации</a>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">За организации</a>
                            <div class="dropdown-menu">
                                {% if not user.is_authenticated %}
                                    <a class="dropdown-item" href="{% url 'organization-register' %}">Регистрация</a>
                                    <a class="dropdown-item" href="{% url 'login' %}">Вход</a>
                                {% else %}
                                    <form method="post" action="{% url 'logout' %}">
                                        {% csrf_token %}
                                        <button type="submit">Изход</button>
                                    </form>
                                {% endif %}
                            </div>
                    </ul>
                </nav>
            {% else %}
                <nav class="navbar navbar-expand-lg navbar-light bg-light mb-5">
                    <ul class="container navbar-nav mx-auto justify-content-between">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'homepage' %}">
                                <img class="img-fluid"
                                     style="height: 150px"
                                     src="{% static 'images/logo.png' %}"  alt="logo">
                            </a>
                        </li>

                        <li class="nav-item dropdown">
                            {% if request.user|has_group:'Organizations' %}
                                <a href="{% url 'organization-pending-adoption-forms' request.user.organization.slug %}">Чакащи одобрение: {{ request.user.organization.submittedadoptionsurvey_set.count }}</a>
                            {% elif request.user|has_group:'Employees' %}
                                <a href="{% url 'organization-pending-adoption-forms' request.user.employee.organization.slug %}">Чакащи одобрение: {{ request.user.employee.organization.submittedadoptionsurvey_set.count }}</a>
                            {% endif %}
                            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">За организации</a>
{#                            <div class="dropdown-menu">#}
                                <div class="dropdown-menu">
                                    <h6 class="dropdown-header">Служители</h6>
                                    <a class="dropdown-item" href="{% url 'organization-register-employee' %}">Регистрирай служител</a>

                                    <h6 class="dropdown-header">Животни</h6>
                                    {% if request.user|has_group:'Organizations' %}
                                        <a class="dropdown-item" href="{% url 'organization-animals' request.user.organization.slug %}">Всички животни</a>
                                    {% elif request.user|has_group:'Employees' %}
                                        <a class="dropdown-item" href="{% url 'organization-animals' request.user.employee.organization.slug %}">Всички животни</a>
                                    {% endif %}
                                    <a class="dropdown-item" href="{% url 'animal-add' %}">Добави животно</a>
                                    <a class="dropdown-item" href="{% url 'foster-homes' %}">Приемни домове</a>

                                    <h6 class="dropdown-header">Анкета за осиновяване</h6>
                                    {% if request.user.organization.adoptionsurvey.questionnaire_text %}
                                        <a class="dropdown-item" href="{% url 'adopt-form-edit' %}">Редактирай анкета за осиновяване</a>
                                    {% else %}
                                        <a class="dropdown-item" href="{% url 'adopt-form-add' %}">Добави  анкета за осиновяване</a>
                                    {% endif %}

                                    <h6 class="dropdown-header">Дарения</h6>
                                    <a class="dropdown-item" href="{% url 'donation-tickets' %}">Всички искания за дарение</a>
                                    <a class="dropdown-item" href="{% url 'donation-ticket-add' %}">Създай искане за дарение</a>
                                    <a class="dropdown-item" href="{% url 'delivery-info' %}">Адреси за дарения</a>
                                    <a class="dropdown-item" href="{% url 'delivery-info-add' %}">Създай адрес за дарения</a>

{#                                        <h6 class="dropdown-header">Доброволчески инициативи</h6>#}
{#                                        <a href="{% url 'donation-tickets' %}">Всички искания за дарение</a>#}
{#                                        <a href="{% url 'donation-ticket-add' %}">Добави искане за дарение</a>#}
{#                                        <a href="{% url 'delivery-info' %}">Адреси за дарения</a>#}
{#                                        <a href="{% url 'delivery-info-add' %}">Добави адрес за дарения</a>#}

                                    <h6 class="dropdown-header">Профил</h6>
                                    {% if request.user|has_group:'Organizations' %}
                                        <a class="dropdown-item" href="{% url 'organization-profile-view' request.user.organization.slug %}">Моят профил</a>
                                    {% elif request.user|has_group:'Employees' %}
                                        <a class="dropdown-item" href="{% url 'employee-profile-view' request.user.employee.pk %}">Моят профил</a>
                                    {% endif %}

                                    <a class="dropdown-item" href="{% url 'donation-ticket-add' %}">Редактирай профил</a>
                                    <a class="dropdown-item" href="{% url 'delivery-info' %}">Изтрий профил</a>

                                    <div class="dropdown-divider"></div>
                                    <form class="dropdown-item" method="post" action="{% url 'logout' %}">
                                        {% csrf_token %}
                                        <button type="submit">Изход</button>
                                    </form>
                                </div>
                    </ul>
                </nav>
            {% endif %}
        </header>
    {% endblock navigation %}

    <main class="flex-grow-1">
        {% block content %}
        {% endblock content %}
    </main>

    {% block footer %}
        <footer class="footer bg-light text-secondary py-4 mt-5">
            <div class="d-flex justify-content-center align-items-center">
                <p>© 2023 - PAWesome - All Rights Reserved.</p>
            </div>
        </footer>
    {% endblock footer %}

    {% block js-scripts %}
    {% endblock js-scripts %}

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>